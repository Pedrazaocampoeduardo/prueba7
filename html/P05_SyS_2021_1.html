<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Pr&aacute;ctica 7: Series de Fourier en tiempo continuo</title>
<meta name="generator" content="MATLAB 23.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2023-11-03">
<meta name="DC.source" content="P05_SyS_2021_1.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>Pr&aacute;ctica 7: Series de Fourier en tiempo continuo</h1>
<!--introduction-->
<p>Moreno Castro Jos&eacute; Pablo Pedraza Ocampo Eduardo Portillo Mart&iacute;nez Carolina Reyes Alvarez</p>
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Problema 1</a>
</li>
<li>
<a href="#2">Problema 2</a>
</li>
<li>
<a href="#3">Prueba</a>
</li>
<li>
<a href="#4">Programa serie de Fourier exponencial complej</a>
</li>
<li>
<a href="#7">Entregables</a>
</li>
</ul>
</div>
<h2 id="1">Problema 1</h2>
<p>La serie de fourier exponencial completa es <img src="P05_SyS_2021_1_eq04795006095091625113.png" alt="$x(t) = \frac{8A}{\pi^2} [ \cos(\pi t - 90^\circ) + \frac{1}{9} \cos(3\pi t + 90^\circ) + \frac{1}{25} \cos(5\pi t - 90^\circ) + \frac{1}{49} \cos (7\pi t + 90^\circ) + \ldots ]$" style="width:557px;height:19px;"> y la compacta es <img src="P05_SyS_2021_1_eq13340183868538080500.png" alt="$x(t) = \frac{8A}{\pi^2} \sum_{n = 1, 3, 5, 7, \ldots} \frac{1}{n^2} \cos(2\pi n t - 90^\circ)$" style="width:251px;height:20px;"></p>
<pre class="codeinput">A = 1;
T = 2;
f0 = 1 / T;
N = 8; <span class="comment">% Cambia este valor a la cantidad de arm&oacute;nicos deseada</span>

t = linspace(-5 * T, 5 * T, 1000);

x_t = (8 * A / pi^2) * cos(2 * pi * 1 * f0 * t - pi/2);
<span class="keyword">for</span> n = 3:2:2*N-1
    x_t = x_t + (8 * A / (pi^2 * n^2)) * cos(2 * pi * n * f0 * t - pi/2);
<span class="keyword">end</span>

subplot(2, 3, 1);
plot(t, x_t, <span class="string">'LineWidth'</span>, 2); <span class="comment">% L&iacute;nea m&aacute;s gruesa</span>
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'x(t)'</span>);
title(<span class="string">'Serie de Fourier (5 Repeticiones)'</span>);
grid <span class="string">on</span>;

<span class="comment">% Genera la se&ntilde;al cuadrada manualmente</span>
x_original = zeros(size(t));
<span class="keyword">for</span> i = 1:numel(t)
    <span class="keyword">if</span> sin(2 * pi * f0 * t(i)) &gt;= 0
        x_original(i) = A;
    <span class="keyword">else</span>
        x_original(i) = -A;
    <span class="keyword">end</span>
<span class="keyword">end</span>

subplot(2, 3, 2);
plot(t, x_t, <span class="string">'b'</span>, t, x_original, <span class="string">'r'</span>, <span class="string">'LineWidth'</span>, 2); <span class="comment">% L&iacute;nea m&aacute;s gruesa y colores</span>
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'x(t)'</span>);
title(<span class="string">'Se&ntilde;al Original y Serie de Fourier (15 Arm&oacute;nicos)'</span>);
legend(<span class="string">'Serie de Fourier'</span>, <span class="string">'Se&ntilde;al Original'</span>);
grid <span class="string">on</span>;

error_t = x_original - x_t;
subplot(2, 3, 3);
plot(t, error_t, <span class="string">'g'</span>, <span class="string">'LineWidth'</span>, 2); <span class="comment">% L&iacute;nea m&aacute;s gruesa y color verde</span>
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'Error'</span>);
title(<span class="string">'Error (Diferencia entre Se&ntilde;al Original y Serie de Fourier)'</span>);
grid <span class="string">on</span>;

E_error = trapz(t, error_t.^2);
subplot(2, 3, 4);
plot(t, error_t.^2, <span class="string">'m'</span>, <span class="string">'LineWidth'</span>, 2); <span class="comment">% L&iacute;nea m&aacute;s gruesa y color magenta</span>
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'Energ&iacute;a'</span>);
title([<span class="string">'Energ&iacute;a del Error = '</span> num2str(E_error)]);
grid <span class="string">on</span>;

frequencies = 0:f0:(N-1)*f0; <span class="comment">% Ajusta el rango de frecuencias</span>
magnitudes = (8 * A / pi^2) * (1 ./ (1:2:2*N-1)).^2;

subplot(2, 3, 5);
stem(frequencies, magnitudes, <span class="string">'b'</span>, <span class="string">'LineWidth'</span>, 2); <span class="comment">% L&iacute;nea m&aacute;s gruesa y color azul</span>
xlabel(<span class="string">'Frecuencia (Hz)'</span>);
ylabel(<span class="string">'Magnitud'</span>);
title(<span class="string">'Espectro de Magnitud (15 Arm&oacute;nicos)'</span>);
grid <span class="string">on</span>;

phases = ones(1, N) * (-pi/2);
subplot(2, 3, 6);
stem(frequencies, phases, <span class="string">'b'</span>, <span class="string">'LineWidth'</span>, 2); <span class="comment">% L&iacute;nea m&aacute;s gruesa y color azul</span>
xlabel(<span class="string">'Frecuencia (Hz)'</span>);
ylabel(<span class="string">'Fase (rad)'</span>);
title(<span class="string">'Espectro de Fase (15 Arm&oacute;nicos)'</span>);
grid <span class="string">on</span>;

sgtitle(<span class="string">'An&aacute;lisis de Serie de Fourier'</span>);
</pre>
<img vspace="5" hspace="5" src="P05_SyS_2021_1_01.png" alt=""> <h2 id="2">Problema 2</h2>
<p>La serie de fourier exponencial completa es <img src="P05_SyS_2021_1_eq12767051270153231660.png" alt="$x(t) = \frac{1}{2} + \frac{2}{\pi} \sum_{n=1}^{\infty} \frac{(-1)^n}{2n-1} \cos(2n-1)w_0t$" style="width:247px;height:21px;"> y la compacta seria <img src="P05_SyS_2021_1_eq04039352484802735801.png" alt="$x(t) = \frac{1}{2} + \frac{2}{\pi} \left( \cos(w_0 t) + \frac{1}{3} \cos(3w_0 t - \pi) + \frac{1}{5} \cos(5w_0 t) + \frac{1}{7} \cos(w_0 t - \pi) + \frac{1}{9} \cos(9w_0 t) + \ldots \right)$" style="width:585px;height:18px;"></p>
<pre class="codeinput">w0 = 2 * pi; <span class="comment">% Frecuencia angular</span>
T0 = 2 * pi / w0; <span class="comment">% Per&iacute;odo fundamental</span>

<span class="comment">% Rango de tiempo para una ventana que muestre 5 repeticiones</span>
t1 = linspace(0, 5 * T0, 1000);

<span class="comment">% Rango de tiempo para una ventana que muestre 15 armonicos</span>
t2 = linspace(0, 15 * T0, 1000);

<span class="comment">% Serie de Fourier truncada para 15 arm&oacute;nicos</span>
N = 15; <span class="comment">% N&uacute;mero de arm&oacute;nicos</span>
x_t = 1/2 + (2/pi) * sum((1./(2 * (1:N) - 1)) .* cos((2 * (1:N) - 1) * w0 * t2));

<span class="comment">% Se&ntilde;al original</span>
x_original = 1/2 + (2/pi) * (cos(w0 * t2) + (1/3) * cos(3 * w0 * t2 - pi) + (1/5) * cos(5 * w0 * t2) + (1/7) * cos(w0 * t2 - pi) + (1/9) * cos(9 * w0 * t2));

<span class="comment">% Error entre la se&ntilde;al original y la serie truncada</span>
error = x_original - x_t;

<span class="comment">% Energ&iacute;a del error</span>
energy_error = trapz(t2, abs(error).^2);

<span class="comment">% Espectro de magnitud</span>
frequencies = (1:N) * w0;
magnitudes = (4/pi) * (1./(2*(1:N)-1));

<span class="comment">% Espectro de fase</span>
phases = -pi/2 * ones(1, N);

<span class="comment">% Gr&aacute;ficas</span>
figure;

subplot(3, 2, 1);
plot(t1, x_t);
title(<span class="string">'Serie de Fourier (5 repeticiones)'</span>);
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'x(t)'</span>);

subplot(3, 2, 2);
plot(t2, x_original, <span class="string">'b'</span>, t2, x_t, <span class="string">'r'</span>);
title(<span class="string">'Se&ntilde;al original y Serie de Fourier (15 arm&oacute;nicos)'</span>);
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'x(t)'</span>);
legend(<span class="string">'Original'</span>, <span class="string">'Fourier'</span>);

subplot(3, 2, 3);
plot(t2, error, <span class="string">'g'</span>);
title(<span class="string">'Error'</span>);
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'Error'</span>);

subplot(3, 2, 4);
text(0.5, 0.5, [<span class="string">'Energ&iacute;a del error = '</span>, num2str(energy_error)]);
axis <span class="string">off</span>;
title(<span class="string">'Energ&iacute;a del Error'</span>);

subplot(3, 2, 5);
stem(frequencies, magnitudes, <span class="string">'k'</span>, <span class="string">'LineWidth'</span>, 1.5);
title(<span class="string">'Espectro de Magnitud'</span>);
xlabel(<span class="string">'Frecuencia (rad/s)'</span>);
ylabel(<span class="string">'Magnitud'</span>);

subplot(3, 2, 6);
stem(frequencies, phases, <span class="string">'b'</span>, <span class="string">'LineWidth'</span>, 1.5);
title(<span class="string">'Espectro de Fase'</span>);
xlabel(<span class="string">'Frecuencia (rad/s)'</span>);
ylabel(<span class="string">'Fase'</span>);

sgtitle(<span class="string">'Gr&aacute;ficas de la Se&ntilde;al y su Serie de Fourier'</span>);
</pre>
<pre class="codeoutput error">Error using *
Incorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of
rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise
multiplication.

Error in P05_SyS_2021_1 (line 101)
x_t = 1/2 + (2/pi) * sum((1./(2 * (1:N) - 1)) .* cos((2 * (1:N) - 1) * w0 * t2));
</pre>
<h2 id="3">Prueba</h2>
<p>Par&aacute;metros de la se&ntilde;al</p>
<pre class="codeinput">A = 1; <span class="comment">% Amplitud</span>
T0 = 2*pi; <span class="comment">% Per&iacute;odo fundamental</span>
N = 15; <span class="comment">% N&uacute;mero de arm&oacute;nicos</span>
t = -5*T0:0.001:5*T0; <span class="comment">% Definici&oacute;n del dominio de tiempo</span>

<span class="comment">% Inicializaci&oacute;n de variables</span>
x = zeros(size(t)); <span class="comment">% Inicializa la se&ntilde;al</span>
error = zeros(size(t)); <span class="comment">% Inicializa el error</span>
energia_error = zeros(1, N); <span class="comment">% Inicializa la energ&iacute;a del error</span>
magnitudes = zeros(1, N); <span class="comment">% Inicializa las magnitudes de los arm&oacute;nicos</span>
fases = zeros(1, N); <span class="comment">% Inicializa las fases de los arm&oacute;nicos</span>

<span class="comment">% C&aacute;lculo de la serie de Fourier</span>
<span class="keyword">for</span> n = 1:N
    omega_n = (2*n - 1) * pi / T0;
    cn = 2 / (pi * (2*n - 1));
    x = x + cn * cos(omega_n * t);
    error = error + cn * cos(omega_n * t) - cn * cos(omega_n * t);
    magnitudes(n) = cn;
    fases(n) = 0; <span class="comment">% Todas las fases son 0 en este caso</span>
    energia_error(n) = sum(error.^2) / length(t);
<span class="keyword">end</span>

<span class="comment">% Gr&aacute;ficas</span>
figure;

<span class="comment">% Gr&aacute;fica de la serie de Fourier en un intervalo que muestre 5 repeticiones</span>
subplot(3, 2, 1);
plot(t, x);
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'x(t)'</span>);
title(<span class="string">'Serie de Fourier (5 repeticiones)'</span>);

<span class="comment">% Gr&aacute;fica de la se&ntilde;al y la serie de Fourier para 15 arm&oacute;nicos</span>
subplot(3, 2, 2);
plot(t, x);
hold <span class="string">on</span>;
plot(t, A * (1/2 + 2/pi * cos(t) + 1/3 * cos(3*t - pi) + 1/5 * cos(5*t) + 1/7 * cos(7*t - pi) + 1/9 * cos(9*t)));
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'x(t)'</span>);
title(<span class="string">'Se&ntilde;al original y Serie de Fourier (15 arm&oacute;nicos)'</span>);

<span class="comment">% Gr&aacute;fica del error</span>
subplot(3, 2, 3);
plot(t, error);
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'Error'</span>);
title(<span class="string">'Error (15 arm&oacute;nicos)'</span>);

<span class="comment">% Gr&aacute;fica de la energ&iacute;a del error</span>
subplot(3, 2, 4);
stem(1:N, energia_error);
xlabel(<span class="string">'Arm&oacute;nico'</span>);
ylabel(<span class="string">'Energ&iacute;a'</span>);
title(<span class="string">'Energ&iacute;a del Error (15 arm&oacute;nicos)'</span>);

<span class="comment">% Espectro de magnitud para 15 arm&oacute;nicos</span>
subplot(3, 2, 5);
stem(1:N, magnitudes, <span class="string">'r'</span>);
xlabel(<span class="string">'Arm&oacute;nico'</span>);
ylabel(<span class="string">'Magnitud'</span>);
title(<span class="string">'Espectro de Magnitud (15 arm&oacute;nicos)'</span>);
axis([0, N+1, 0, 1]);

<span class="comment">% Espectro de fase para 15 arm&oacute;nicos</span>
subplot(3, 2, 6);
stem(1:N, fases, <span class="string">'b'</span>);
xlabel(<span class="string">'Arm&oacute;nico'</span>);
ylabel(<span class="string">'Fase'</span>);
title(<span class="string">'Espectro de Fase (15 arm&oacute;nicos)'</span>);

sgtitle(<span class="string">'An&aacute;lisis de la Serie de Fourier'</span>);
</pre>
<h2 id="4">Programa serie de Fourier exponencial complej</h2>
<p>La serie de Fourier de una se&ntilde;al <img src="P05_SyS_2021_1_eq03669012802637024050.png" alt="$f(t)$" style="width:24px;height:15px;"> peri&oacute;dica puede ser construida bajo ciertas condiciones matem&aacute;ticas (las condiciones de Dirichlet, aunque estas podr&iacute;an no cumplirse y a&uacute;n as&iacute; la serie existir) de la se&ntilde;al. Si la se&ntilde;al no es peri&oacute;dica pero cumple las condiciones en un intervalo de longitud finita, se puede construir la serie de Fourier en el intervalo (cuando el intervalo es de longitud infinita se puede abordar a la suma de Fourier, exponencial compleja, como una integral y los coeficientes <img src="P05_SyS_2021_1_eq18214838177982593605.png" alt="$D_n$" style="width:18px;height:13px;"> son muestras de lo que llamamos transformada de Fourier.)</p>
<p>Deber&aacute;s realizar algunos problemas con las especificaciones que se encuentran al final del documento, para ello se proporciona el siguiente c&oacute;digo, que gr&aacute;fica la serie de Fourier exponencial compleja.</p>
<pre class="language-matlab">
<span class="keyword">function</span> varargout = sfc( method, varargin)
<span class="comment">% This is an entry point into Stateflow Code Generator</span>
<span class="comment">% for internal use only and not for general use.</span>
<span class="comment">% Help text is suppressed intentionally as</span>
<span class="comment">% this function is called by Stateflow internal code.</span>
<span class="comment">% Please refer to Stateflow API documentation for details</span>
<span class="comment">% on command line interface to code-generation.</span>
<span class="comment">%</span>

<span class="comment">%</span>
<span class="comment">%   Copyright 1995-2019 The MathWorks, Inc.</span>
<span class="comment">%</span>
<span class="keyword">if</span>(nargin&lt;1)
    help(mfilename);
    <span class="keyword">return</span>;
<span class="keyword">end</span>

<span class="keyword">switch</span>(lower(method))
    <span class="keyword">case</span> <span class="string">'coder_options'</span>
        varargout = cell(1,max(1,nargout));
        varargout{:} = coder_options(varargin{:});
        <span class="keyword">return</span>;
    <span class="keyword">case</span> <span class="string">'private'</span>
        <span class="keyword">if</span>(length(varargin)&lt;1)
            construct_coder_error([],<span class="string">''</span>,1);
            <span class="keyword">return</span>;
        <span class="keyword">end</span>
        fcnName = varargin{1};
        inArgs = varargin(2:end);
        <span class="keyword">if</span>(nargout&gt;0)
            varargout = cell(1,nargout);
            [varargout{:}] = feval(fcnName,inArgs{:});
        <span class="keyword">else</span>
            feval(fcnName,inArgs{:});
        <span class="keyword">end</span>
        <span class="keyword">return</span>;
    <span class="keyword">case</span> <span class="string">'revision'</span>
        varargout{1} = <span class="string">'  '</span>;
        <span class="keyword">return</span>;
    <span class="keyword">case</span> <span class="string">'language'</span>
        varargout{1} = <span class="string">'ANSI-C'</span>;
        <span class="keyword">return</span>;
    <span class="keyword">case</span> {<span class="string">'clean_objects'</span>,<span class="string">'clean'</span>,<span class="string">'code'</span>,<span class="string">'codeincremental'</span>,<span class="string">'codenonincremental'</span>,<span class="string">'filenameinfo'</span>,<span class="string">'makeinfo'</span>,<span class="string">'construct_chart_ir_for_rtw'</span>}
        <span class="comment">%WISH error check nargin</span>
        <span class="keyword">if</span>(length(varargin)&lt;1)
            errorMsg = sprintf(<span class="string">'Usage: sfc(methodName,targetId[,parentTargetId])'</span>);
            construct_coder_error([], errorMsg,1);
            <span class="keyword">return</span>;
        <span class="keyword">end</span>

        target = varargin{1};

        <span class="keyword">if</span>(length(target)~=1 || ~sf(<span class="string">'ishandle'</span>,target))
            errorMsg = sprintf(<span class="string">'sfc invoked with invalid target id %d.'</span>,target);
            construct_coder_error([], errorMsg,1);
            <span class="keyword">return</span>;
        <span class="keyword">end</span>

        <span class="keyword">if</span>(length(varargin)&gt;1)
            parentTarget = varargin{2};
        <span class="keyword">else</span>
            parentTarget = target;
        <span class="keyword">end</span>
        <span class="keyword">if</span>(length(varargin)&gt;=3)
            mainMachineId = varargin{3};
        <span class="keyword">else</span>
            mainMachineId = 0;
        <span class="keyword">end</span>
        <span class="keyword">if</span>(length(varargin)&gt;=4)
            currentChartId = varargin{4};
        <span class="keyword">else</span>
            currentChartId = [];
        <span class="keyword">end</span>
        <span class="keyword">if</span>(length(varargin)&gt;=5)
            auxiliaryInfo = varargin{5};
        <span class="keyword">else</span>
            auxiliaryInfo = [];
        <span class="keyword">end</span>
        <span class="keyword">if</span>(length(varargin)&gt;=6)
            hChart = varargin{6};
        <span class="keyword">else</span>
            hChart = [];
        <span class="keyword">end</span>

        <span class="keyword">if</span>(length(parentTarget)~=1 || ~sf(<span class="string">'ishandle'</span>,parentTarget))
            errorMsg = sprintf(<span class="string">'sfc invoked with invalid parent target id %d.'</span>,parentTarget);
            construct_coder_error([], errorMsg,1);
        <span class="keyword">end</span>
    <span class="keyword">otherwise</span>
        construct_coder_error([],<span class="string">''</span>,1);
        <span class="keyword">return</span>;
<span class="keyword">end</span>

sfprivate(<span class="string">'coder_error_count_man'</span>,<span class="string">'reset'</span>);

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%%%%%%%%%%%%%%%%%%%% GLOBAL FLAGS AND ARRAYS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="keyword">global</span> gTargetInfo gChartInfo gDataInfo gMachineInfo <span class="comment">%#ok&lt;GVMIS,NUSED&gt;</span>

<span class="comment">%%%%%%%BEGIN: MINIMAL STUFF THAT NEEDS TO BE DONE%%%%%%%</span>

gMachineInfo.target = target;
gMachineInfo.parentTarget = parentTarget;

gMachineInfo.mainMachineId = mainMachineId;
gMachineInfo.machineId = sf(<span class="string">'get'</span>,gMachineInfo.target,<span class="string">'target.machine'</span>);
<span class="keyword">if</span>(isempty(gMachineInfo.mainMachineId) || gMachineInfo.mainMachineId==0)
    gMachineInfo.mainMachineId = gMachineInfo.machineId;
<span class="keyword">end</span>

gMachineInfo.charts = sfprivate(<span class="string">'get_instantiated_charts_in_machine'</span>,gMachineInfo.machineId);
gMachineInfo.specializations = {};
singleChartCodegen = ~isempty(currentChartId);
<span class="keyword">if</span> singleChartCodegen
    <span class="comment">% this is used for HDL,PLC and other custom targets</span>
    <span class="comment">% for specified chart(s) only non-incrementally.</span>
    <span class="comment">%gMachineInfo.charts = intersect(gMachineInfo.charts, currentChartId);</span>
    gMachineInfo.charts = currentChartId;
    <span class="keyword">if</span> ~isempty(hChart)
        spec = sf(<span class="string">'SFunctionSpecialization'</span>, currentChartId, hChart);
        gMachineInfo.specializations = {{spec}};
    <span class="keyword">end</span>
<span class="keyword">end</span>
chartFileNumbers = sf(<span class="string">'get'</span>,gMachineInfo.charts,<span class="string">'chart.chartFileNumber'</span>);
[~,sortedIndices] = sort(chartFileNumbers);
gMachineInfo.charts = gMachineInfo.charts(sortedIndices);

gTargetInfo.target = target;
gTargetInfo.parentTarget = parentTarget;

<span class="comment">%%%%%%%END:  MINIMAL STUFF THAT NEEDS TO BE DONE%%%%%%%</span>

<span class="comment">% The reason for using on cleanup up front instead of doing an explicit</span>
<span class="comment">% cdr_cleanup_all_info at the  end is that some of these methods throw</span>
<span class="comment">% exceptions and we might get an early return from somewhere in the middle</span>
<span class="comment">% of these switch cases.</span>
cleaner = onCleanup(@() cdr_cleanup_all_info);

<span class="keyword">switch</span>(method)
    <span class="keyword">case</span> <span class="string">'clean'</span>
        [~, varargout{1}] = cdr_init_all_info;
        clean_code_gen_dir(varargout{1}.targetDirName');
    <span class="keyword">case</span> <span class="string">'clean_objects'</span>
        [~, varargout{1}] = cdr_init_all_info;
        clean_code_gen_dir(varargout{1}.targetDirName,1);
    <span class="keyword">case</span> {<span class="string">'code'</span>,<span class="string">'codeIncremental'</span>,<span class="string">'codeNonIncremental'</span>}
        <span class="keyword">switch</span>(method)
            <span class="keyword">case</span> {<span class="string">'code'</span>,<span class="string">'codeIncremental'</span>}
                codingRebuildAll=0;
            <span class="keyword">case</span> {<span class="string">'codeNonIncremental'</span>}
                codingRebuildAll=1;
        <span class="keyword">end</span>
        [status, varargout{1}] = cdr_init_all_info;
        sf(<span class="string">'set'</span>,gTargetInfo.target,<span class="string">'target.makeInfo'</span>,varargout{1});

        <span class="keyword">if</span> singleChartCodegen
            codingRebuildAll = 1;
        <span class="keyword">end</span>

        <span class="keyword">if</span> ~status
            status = construct_context_for_machine;
        <span class="keyword">end</span>
        <span class="keyword">if</span>(~status)
            generate_code_for_charts_and_machine(varargout{1},codingRebuildAll);
        <span class="keyword">end</span>
    <span class="keyword">case</span> <span class="string">'construct_chart_ir_for_rtw'</span>
        compute_target_info();
        compute_machine_info();
        gTargetInfo.codingIRConstructionForRTW = true;
        <span class="keyword">if</span> gTargetInfo.gencpp
            gTargetInfo.fileNameInfo = create_file_name_info();
        <span class="keyword">end</span>
        status = construct_context_for_machine(auxiliaryInfo);
        <span class="keyword">if</span> ~status
            construct_chart_ir_for_rtw(currentChartId, hChart);
        <span class="keyword">end</span>
    <span class="keyword">case</span> <span class="string">'filenameinfo'</span>
        [~, varargout{1}] = cdr_init_all_info;
    <span class="keyword">case</span> <span class="string">'makeinfo'</span>
        [~, makeInfo.fileNameInfo] =  cdr_init_all_info;
        varargout{1} = makeInfo;
    <span class="keyword">otherwise</span>
        construct_coder_error([],<span class="string">''</span>,1);
<span class="keyword">end</span>

<span class="keyword">return</span>;

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="keyword">function</span> [status, fileNameInfo] = cdr_init_all_info

status = 0;
compute_target_info();
compute_machine_info();
fileNameInfo = create_file_name_info();

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="keyword">function</span> cdr_cleanup_all_info
<span class="keyword">global</span> gMachineInfo <span class="comment">%#ok&lt;GVMIS&gt;</span>
sf(<span class="string">'set'</span>,gMachineInfo.machineId,<span class="string">'machine.activeTarget'</span>,0);
sf(<span class="string">'set'</span>,gMachineInfo.machineId,<span class="string">'machine.activeParentTarget'</span>,0);
clear <span class="string">global</span> <span class="string">gMachineInfo</span> <span class="string">gTargetInfo</span> <span class="string">gChartInfo</span> <span class="string">gDataInfo</span>



</pre>
<p>Por ejemplo si</p>
<p>
<img src="P05_SyS_2021_1_eq17045788404663626359.png" alt="$$f(t)=e^{-t/2};\;\; 0<t<\pi$$" style="width:149px;height:18px;"></p>
<p>peri&oacute;dica, entonces si se calcula la serie de Fourier exponencial compleja se utilizan las siguientes instrucciones para observar las gr&aacute;ficas correspondientes</p>
<pre class="codeinput">d0=0.504;
dn=@(n) 0.504/(1+4*n*j);
t0=0;
tf=pi;
f=@(t) exp(-t/2);
armo=4;
a=-7;
b=7;
sfc(t0,tf,dn,d0,f,armo,a,b)
</pre>
<h2 id="7">Entregables</h2>
<p>Se revisa una publicaci&oacute;n (html) de la pr&aacute;ctica. En este caso inicie indicando el nombre de la pr&aacute;ctica y los datos del equipo (Portada). El &iacute;ndice del contenido lo genera Publish (&Iacute;ndice). Los objetivos son los sigueintes:</p>
<div>
<ul>
<li>Realizar gr&aacute;ficas de series de Fourier exponenciales y trigonom&eacute;tricas en tiempo continuo</li>
<li>Manipulaci&oacute;n de instrucciones en MATLAB</li>
</ul>
</div>
<p>No hay investigaci&oacute;n para la introducci&oacute;n</p>
<p>Para el desarrollo se tienen que resolver cada uno de los siguientes problemas comenzando una nueva secci&oacute;n (para la publicaci&oacute;n) en cada uno de ellos.</p>
<p>Cada problema se realiza para serie trigonom&eacute;trica compacta y exponencial compleja, cada figura debe contener</p>
<div>
<ol>
<li>Gr&aacute;fica de la serie de Fourier en un intervalo que muestre 5 repeticiones</li>
<li>Gr&aacute;fica de la se&ntilde;al y la serie de Fourier para 15 armonicos</li>
<li>Gr&aacute;fica del error</li>
<li>Gr&aacute;fica de la energ&iacute;a del error</li>
<li>Espectro de magnitud para 15 armonicos</li>
<li>Espectro de fase para 15 armonicos</li>
</ol>
</div>
<div>
<ul>
<li>
<b>Ejemplo 6.2</b> Agregar la expresi&oacute;n an&aacute;litica de la serie en ambos formatos. Utilizar A =1.</li>
</ul>
</div>
<div>
<ul>
<li>
<b>Ejemplo 6.4</b> Agregar la expresi&oacute;n an&aacute;litica de la serie en ambos formatos.</li>
</ul>
</div>
<div>
<ul>
<li>
<b>PR08</b> Agregar la expresi&oacute;n an&aacute;litica de la serie en ambos formatos (hay dos series en esta tarea).</li>
</ul>
</div>
<div>
<ul>
<li>
<b>PR10</b> Agregar la expresi&oacute;n an&aacute;litica de la serie en ambos formatos (ejercicio 1 y <img src="P05_SyS_2021_1_eq08775146270570894060.png" alt="$a=2$" style="width:34px;height:10px;">).</li>
</ul>
</div>
<p>No es necesario incluir conclusiones en esta pr&aacute;ctica, como ap&eacute;ndices agregue los c&oacute;digos que utiliz&oacute;, no olvide incluir sus referencias.</p>
<p>El c&oacute;digo de esta publicaci&oacute;n lo puedes encontrar en el siguiente <a href="https://www.dropbox.com/s/a7bc9looozmx8lt/P05_SyS_2021_1.m?dl=0">enlace</a>
</p>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% Práctica 7: Series de Fourier en tiempo continuo
% Moreno Castro José Pablo
% Pedraza Ocampo Eduardo
% Portillo Martínez Carolina
% Reyes Alvarez


%% Problema 1
% La serie de fourier exponencial completa es $x(t) = \frac{8A}{\pi^2} [ \cos(\pi t - 90^\circ) + \frac{1}{9} \cos(3\pi t + 90^\circ) + \frac{1}{25} \cos(5\pi t - 90^\circ) + \frac{1}{49} \cos (7\pi t + 90^\circ) + \ldots ]$  y la compacta es $x(t) = \frac{8A}{\pi^2} \sum_{n = 1, 3, 5, 7, \ldots} \frac{1}{n^2} \cos(2\pi n t - 90^\circ)$
A = 1;
T = 2;
f0 = 1 / T;
N = 8; % Cambia este valor a la cantidad de armónicos deseada

t = linspace(-5 * T, 5 * T, 1000);

x_t = (8 * A / pi^2) * cos(2 * pi * 1 * f0 * t - pi/2);
for n = 3:2:2*N-1
    x_t = x_t + (8 * A / (pi^2 * n^2)) * cos(2 * pi * n * f0 * t - pi/2);
end

subplot(2, 3, 1);
plot(t, x_t, 'LineWidth', 2); % Línea más gruesa
xlabel('t');
ylabel('x(t)');
title('Serie de Fourier (5 Repeticiones)');
grid on;

% Genera la señal cuadrada manualmente
x_original = zeros(size(t));
for i = 1:numel(t)
    if sin(2 * pi * f0 * t(i)) >= 0
        x_original(i) = A;
    else
        x_original(i) = -A;
    end
end

subplot(2, 3, 2);
plot(t, x_t, 'b', t, x_original, 'r', 'LineWidth', 2); % Línea más gruesa y colores
xlabel('t');
ylabel('x(t)');
title('Señal Original y Serie de Fourier (15 Armónicos)');
legend('Serie de Fourier', 'Señal Original');
grid on;

error_t = x_original - x_t;
subplot(2, 3, 3);
plot(t, error_t, 'g', 'LineWidth', 2); % Línea más gruesa y color verde
xlabel('t');
ylabel('Error');
title('Error (Diferencia entre Señal Original y Serie de Fourier)');
grid on;

E_error = trapz(t, error_t.^2);
subplot(2, 3, 4);
plot(t, error_t.^2, 'm', 'LineWidth', 2); % Línea más gruesa y color magenta
xlabel('t');
ylabel('Energía');
title(['Energía del Error = ' num2str(E_error)]);
grid on;

frequencies = 0:f0:(N-1)*f0; % Ajusta el rango de frecuencias
magnitudes = (8 * A / pi^2) * (1 ./ (1:2:2*N-1)).^2;

subplot(2, 3, 5);
stem(frequencies, magnitudes, 'b', 'LineWidth', 2); % Línea más gruesa y color azul
xlabel('Frecuencia (Hz)');
ylabel('Magnitud');
title('Espectro de Magnitud (15 Armónicos)');
grid on;

phases = ones(1, N) * (-pi/2);
subplot(2, 3, 6);
stem(frequencies, phases, 'b', 'LineWidth', 2); % Línea más gruesa y color azul
xlabel('Frecuencia (Hz)');
ylabel('Fase (rad)');
title('Espectro de Fase (15 Armónicos)');
grid on;

sgtitle('Análisis de Serie de Fourier');


%% Problema 2
% La serie de fourier exponencial completa es $x(t) = \frac{1}{2} +
% \frac{2}{\pi} \sum_{n=1}^{\infty} \frac{(-1)^n}{2n-1} \cos(2n-1)w_0t$ y
% la compacta seria $x(t) = \frac{1}{2} + \frac{2}{\pi} \left( \cos(w_0 t) + \frac{1}{3} \cos(3w_0 t - \pi) + \frac{1}{5} \cos(5w_0 t) + \frac{1}{7} \cos(w_0 t - \pi) + \frac{1}{9} \cos(9w_0 t) + \ldots \right)$ 
% 

w0 = 2 * pi; % Frecuencia angular
T0 = 2 * pi / w0; % Período fundamental

% Rango de tiempo para una ventana que muestre 5 repeticiones
t1 = linspace(0, 5 * T0, 1000);

% Rango de tiempo para una ventana que muestre 15 armonicos
t2 = linspace(0, 15 * T0, 1000);

% Serie de Fourier truncada para 15 armónicos
N = 15; % Número de armónicos
x_t = 1/2 + (2/pi) * sum((1./(2 * (1:N) - 1)) .* cos((2 * (1:N) - 1) * w0 * t2));

% Señal original
x_original = 1/2 + (2/pi) * (cos(w0 * t2) + (1/3) * cos(3 * w0 * t2 - pi) + (1/5) * cos(5 * w0 * t2) + (1/7) * cos(w0 * t2 - pi) + (1/9) * cos(9 * w0 * t2));

% Error entre la señal original y la serie truncada
error = x_original - x_t;

% Energía del error
energy_error = trapz(t2, abs(error).^2);

% Espectro de magnitud
frequencies = (1:N) * w0;
magnitudes = (4/pi) * (1./(2*(1:N)-1));

% Espectro de fase
phases = -pi/2 * ones(1, N);

% Gráficas
figure;

subplot(3, 2, 1);
plot(t1, x_t);
title('Serie de Fourier (5 repeticiones)');
xlabel('t');
ylabel('x(t)');

subplot(3, 2, 2);
plot(t2, x_original, 'b', t2, x_t, 'r');
title('Señal original y Serie de Fourier (15 armónicos)');
xlabel('t');
ylabel('x(t)');
legend('Original', 'Fourier');

subplot(3, 2, 3);
plot(t2, error, 'g');
title('Error');
xlabel('t');
ylabel('Error');

subplot(3, 2, 4);
text(0.5, 0.5, ['Energía del error = ', num2str(energy_error)]);
axis off;
title('Energía del Error');

subplot(3, 2, 5);
stem(frequencies, magnitudes, 'k', 'LineWidth', 1.5);
title('Espectro de Magnitud');
xlabel('Frecuencia (rad/s)');
ylabel('Magnitud');

subplot(3, 2, 6);
stem(frequencies, phases, 'b', 'LineWidth', 1.5);
title('Espectro de Fase');
xlabel('Frecuencia (rad/s)');
ylabel('Fase');

sgtitle('Gráficas de la Señal y su Serie de Fourier');



%% Prueba
% Parámetros de la señal
A = 1; % Amplitud
T0 = 2*pi; % Período fundamental
N = 15; % Número de armónicos
t = -5*T0:0.001:5*T0; % Definición del dominio de tiempo

% Inicialización de variables
x = zeros(size(t)); % Inicializa la señal
error = zeros(size(t)); % Inicializa el error
energia_error = zeros(1, N); % Inicializa la energía del error
magnitudes = zeros(1, N); % Inicializa las magnitudes de los armónicos
fases = zeros(1, N); % Inicializa las fases de los armónicos

% Cálculo de la serie de Fourier
for n = 1:N
    omega_n = (2*n - 1) * pi / T0;
    cn = 2 / (pi * (2*n - 1));
    x = x + cn * cos(omega_n * t);
    error = error + cn * cos(omega_n * t) - cn * cos(omega_n * t);
    magnitudes(n) = cn;
    fases(n) = 0; % Todas las fases son 0 en este caso
    energia_error(n) = sum(error.^2) / length(t);
end

% Gráficas
figure;

% Gráfica de la serie de Fourier en un intervalo que muestre 5 repeticiones
subplot(3, 2, 1);
plot(t, x);
xlabel('t');
ylabel('x(t)');
title('Serie de Fourier (5 repeticiones)');

% Gráfica de la señal y la serie de Fourier para 15 armónicos
subplot(3, 2, 2);
plot(t, x);
hold on;
plot(t, A * (1/2 + 2/pi * cos(t) + 1/3 * cos(3*t - pi) + 1/5 * cos(5*t) + 1/7 * cos(7*t - pi) + 1/9 * cos(9*t)));
xlabel('t');
ylabel('x(t)');
title('Señal original y Serie de Fourier (15 armónicos)');

% Gráfica del error
subplot(3, 2, 3);
plot(t, error);
xlabel('t');
ylabel('Error');
title('Error (15 armónicos)');

% Gráfica de la energía del error
subplot(3, 2, 4);
stem(1:N, energia_error);
xlabel('Armónico');
ylabel('Energía');
title('Energía del Error (15 armónicos)');

% Espectro de magnitud para 15 armónicos
subplot(3, 2, 5);
stem(1:N, magnitudes, 'r');
xlabel('Armónico');
ylabel('Magnitud');
title('Espectro de Magnitud (15 armónicos)');
axis([0, N+1, 0, 1]);

% Espectro de fase para 15 armónicos
subplot(3, 2, 6);
stem(1:N, fases, 'b');
xlabel('Armónico');
ylabel('Fase');
title('Espectro de Fase (15 armónicos)');

sgtitle('Análisis de la Serie de Fourier');



%% Programa serie de Fourier exponencial complej
%
% La serie de Fourier de una señal $f(t)$ periódica puede ser construida  
% bajo ciertas condiciones matemáticas (las condiciones de Dirichlet, aunque estas podrían no 
% cumplirse y aún así la serie existir) de la señal. Si la señal
% no es periódica pero cumple las condiciones en un intervalo de longitud
% finita,
% se puede construir la serie de
% Fourier en el intervalo (cuando el intervalo 
% es de longitud infinita se puede abordar a la suma de Fourier, 
% exponencial compleja, como una integral y los coeficientes 
% $D_n$ son muestras de lo que llamamos transformada de Fourier.)
%
% Deberás realizar algunos problemas con las especificaciones que
% se encuentran al final del documento, para ello se proporciona el 
% siguiente código, que gráfica la serie de Fourier exponencial compleja.  
%%
%
% <include>sfc.m</include>
%
% Por ejemplo si 
%%
% 
% $$f(t)=e^{-t/2};\;\; 0<t<\pi$$
% 
% periódica, entonces si se calcula la serie de Fourier exponencial compleja
% se utilizan las siguientes instrucciones para observar las gráficas
% correspondientes

d0=0.504;
dn=@(n) 0.504/(1+4*n*j);
t0=0;
tf=pi;
f=@(t) exp(-t/2);
armo=4;
a=-7;
b=7;
sfc(t0,tf,dn,d0,f,armo,a,b)

%% Entregables
% Se revisa una publicación (html) de la práctica. En este caso inicie
% indicando el nombre de la práctica y los datos del equipo 
% (Portada). El índice del contenido lo genera Publish (Índice). Los
% objetivos son los sigueintes:
%
% * Realizar gráficas de series de Fourier exponenciales y trigonométricas
% en tiempo continuo
% * Manipulación de instrucciones en MATLAB
%
% No hay investigación para la introducción
%
% Para el desarrollo se tienen que resolver cada uno de los siguientes
% problemas comenzando una nueva sección (para la publicación) en cada uno de ellos.
%
% Cada problema se realiza para serie trigonométrica compacta y 
% exponencial compleja, cada figura debe contener 
% 
% # Gráfica de la serie de Fourier en un intervalo que muestre 5
% repeticiones
% # Gráfica de la señal y la serie de Fourier para 15 armonicos
% # Gráfica del error
% # Gráfica de la energía del error
% # Espectro de magnitud  para 15 armonicos
% # Espectro de fase para 15 armonicos
% 
% * *Ejemplo 6.2*  Agregar la expresión análitica
% de la serie en ambos formatos. Utilizar A =1.
%
% * *Ejemplo 6.4* Agregar la expresión análitica
% de la serie en ambos formatos.
% 
% * *PR08* Agregar la expresión análitica
% de la serie en ambos formatos (hay dos series en esta tarea).
%
% * *PR10* Agregar la expresión análitica
% de la serie en ambos formatos (ejercicio 1 y $a=2$).
%
% No es necesario incluir conclusiones en esta práctica, como apéndices 
% agregue los códigos que utilizó, no olvide incluir sus referencias. 
%
% El código de esta publicación lo puedes encontrar en el siguiente 
% <https://www.dropbox.com/s/a7bc9looozmx8lt/P05_SyS_2021_1.m?dl=0 enlace>





##### SOURCE END #####
-->
</body>
</html>
